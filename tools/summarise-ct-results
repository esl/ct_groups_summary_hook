#!/usr/bin/env escript

main(Files) ->
    Result = lists:foldl(fun(Filename, {OkAcc, FAcc, USAcc, ASAcc}) ->
        {ok, [{summary, {Ok, F, US, AS}}]} = file:consult(Filename),
        {OkAcc+Ok, FAcc+F, USAcc+US, ASAcc+AS}
    end, {0, 0, 0, 0}, Files),
    {Ok, Failed, UserSkipped, AutoSkipped} = Result,
    io:format("CT results:~n"
              "    ~p tests passed~n"
              "    ~p tests failed~n"
              "    ~p tests skipped by user~n"
              "    ~p tests skipped automatically~n",
          [Ok, Failed, UserSkipped, AutoSkipped]),
    erlang:halt(Failed+UserSkipped+AutoSkipped).
